{"mappings":"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","sources":["src/js/04-resinTimer.js"],"sourcesContent":["import 'flatpickr/dist/flatpickr.min.css';\n// import flatpickr from 'flatpickr';\nimport { Notify } from 'notiflix/build/notiflix-notify-aio';\n\nconst RESIN_MS = 8 * 60 * 1000;\nconst RESIN_MS_DAILY_DELAY = 5 * 60 * 1000 + 5 * 1000; //-5min +5sec\nconst DATE_DISPLAY_OPTIONS = {\n  year: 'numeric',\n  month: 'long',\n  day: 'numeric',\n  hour: 'numeric',\n  minute: 'numeric',\n}; //weekday: 'long',\n\nconst resinInput = document.querySelector('#resin');\nconst resin = () => parseInt(resinInput.value) || 0;\n\nconst saving = () => document.querySelector('#save').checked;\n\nconst next20 = document.querySelector('[data-20]');\nconst next40 = document.querySelector('[data-40]');\nconst next60 = document.querySelector('[data-60]');\nconst next120 = document.querySelector('[data-120]');\nconst fullAt = document.querySelector('[data-date]');\nconst add20 = document.querySelector('[data-plus]');\nconst remove20 = document.querySelector('[data-minus]');\nconst warningFull = document.querySelector('[data-warningFull]');\nconst saveCheckbox = document.querySelector('#save');\nconst title = document.querySelector('title');\n\nlet initNow = 0; //Number(new Date() - RESIN_MS_DAILY_DELAY); //.getTime();\n\nlet lastData = {\n  date: Number(new Date() - RESIN_MS_DAILY_DELAY),\n  resin: resin(),\n  saving: true,\n};\nconst saveData = () => {\n  setIcon();\n  if (saving()) {\n    const settings = {\n      date: Number(new Date() - RESIN_MS_DAILY_DELAY),\n      resin: resin(),\n      saving: true,\n    };\n    console.log(settings);\n    localStorage.setItem('save', JSON.stringify(settings));\n    Notify.success('Saving data.');\n  }\n};\nconst updateData = () => {\n  if (!lastData) {\n    lastData = {\n      date: Number(new Date() - RESIN_MS_DAILY_DELAY),\n      resin: resin(),\n      saving: false,\n    };\n  }\n  initNow = Number(new Date() - RESIN_MS_DAILY_DELAY);\n  const betweenSavedTime = initNow - lastData.date;\n  const addedResin = Math.floor(betweenSavedTime / RESIN_MS) - 0;\n  const newResin = 0 + Number(lastData.resin + addedResin);\n  // Notify.failure(\n  //   `resin previously:${lastData.resin} resin to be added: ${addedResin} newResin =${newResin}`\n  // );\n  if (lastData.resin != newResin) {\n    Notify.warning(\n      'Updated ' +\n        lastData.resin +\n        ' -> ' +\n        newResin +\n        ' (time= ' +\n        betweenSavedTime +\n        ' )'\n    );\n    // Notify.warning('Updated');\n  }\n  resinInput.value = newResin;\n};\nconst loadData = () => {\n  lastData = JSON.parse(localStorage.getItem('save'));\n  updateData();\n  document.querySelector('#save').checked = JSON.parse(lastData.saving);\n  // resinInput.value = lastData.resin;\n  if (saving()) Notify.warning('Data loaded.');\n};\nloadData();\nconst onSaveCheckbox = () => {\n  if (saving()) {\n    saveData();\n  } else {\n    Notify.failure('Deleting data from local storage.');\n    lastData = {\n      date: Number(new Date() - RESIN_MS_DAILY_DELAY),\n      resin: resin(),\n      saving: false,\n    };\n    localStorage.setItem('save', '');\n  }\n};\n\nlet timer = null;\nlet singleResinTimer = null;\nlet SRTInterval = 0;\n\nconst SRTTick = () => {\n  console.log('tick: got one resin more');\n  resinInput.value = Number(resin()) + 1;\n  saveData();\n  Notify.info(`Resin increased to ${resinInput.value}`);\n};\n\nconst getMSToNearestResin = () => {\n  const now = new Date();\n  const todayMS =\n    now.getHours() * 60 * 60 * 1000 +\n    now.getMinutes() * 60 * 1000 +\n    now.getSeconds() * 1000 +\n    now.getMilliseconds() -\n    RESIN_MS_DAILY_DELAY;\n\n  const nextRMS = RESIN_MS - (todayMS % RESIN_MS);\n  const nextRMins = Math.floor(nextRMS / 60000) - 0;\n  const nextRSecs = Math.floor((nextRMS - nextRMins * 60 * 1000) / 1000) - 0;\n  Notify.info(`Resin incease in ${nextRMins}m  ${nextRSecs - 1}s`);\n  return nextRMS;\n};\n\nfunction objectifyMs(ms) {\n  const second = 1000;\n  const minute = second * 60;\n  const hour = minute * 60;\n  const day = hour * 24;\n  const days = String(Math.floor(ms / day)).padStart(2, 0);\n  const hours = String(Math.floor((ms % day) / hour)).padStart(2, 0);\n  const minutes = String(Math.floor(((ms % day) % hour) / minute)).padStart(\n    2,\n    0\n  );\n  const seconds = String(\n    Math.floor((((ms % day) % hour) % minute) / second)\n  ).padStart(2, 0);\n  return { days, hours, minutes, seconds };\n}\nconst resinToMSec = r => r * RESIN_MS + initNow;\nconst getGoalDateByResin = (resin, neededResin) => {\n  const diff = neededResin - (resin % neededResin);\n  return resinToMSec(diff);\n};\nconst DateObjToStr = (d, format = 'date') => {\n  // formats: 'date' or 'countdown'\n  // date time when finish / hours minutes to the end\n  return format == 'date'\n    ? `date `\n    : `${d.hours}h  ${d.minutes}min ${d.seconds}s`;\n};\nconst dateToStr = d => {\n  // const month\n  return ``;\n};\nconst updateR = () => {\n  const filledMS = getGoalDateByResin(resin(), 160);\n  const filledDate = new Date(filledMS);\n  let timeDifference = Number(filledMS) - Number(new Date());\n  let countdown = objectifyMs(timeDifference);\n  next20.innerHTML = DateObjToStr(\n    objectifyMs(Number(getGoalDateByResin(resin(), 20)) - Number(new Date())),\n    'countdown'\n  );\n  next40.innerHTML = DateObjToStr(\n    objectifyMs(Number(getGoalDateByResin(resin(), 40)) - Number(new Date())),\n    'countdown'\n  );\n  const d60 = new Date(\n    Number(getGoalDateByResin(resin(), 60))\n  ).toLocaleDateString('pl-PL', DATE_DISPLAY_OPTIONS);\n  next60.innerHTML = d60;\n  const d120 = new Date(\n    Number(getGoalDateByResin(resin(), 120))\n  ).toLocaleDateString('pl-PL', DATE_DISPLAY_OPTIONS);\n  next120.innerHTML = d120;\n  fullAt.innerHTML = new Date(\n    Number(getGoalDateByResin(resin(), 160))\n  ).toLocaleDateString('pl-PL', DATE_DISPLAY_OPTIONS);\n  // Notify.failure(filledDate.getHours());\n  warningFull.innerHTML =\n    Number(filledDate.getDay()) == Number(new Date().getDay())\n      ? ' Dzisiaj'\n      : filledDate.getHours() < 9\n      ? 'Rano'\n      : ' ';\n  // daysDisplay.innerHTML = countdown.days;\n  // hoursDisplay.innerHTML = countdown.hours;\n  // minutesDisplay.innerHTML = countdown.minutes;\n  // secondsDisplay.innerHTML = countdown.seconds;\n};\nconst setRTimer = () => {\n  updateR();\n  timer = setInterval(updateR, 1000);\n};\nconst onInputResinChange = () => {\n  saveData();\n};\nfunction changeFavicon(text) {\n  const canvas = document.createElement('canvas');\n  canvas.height = 64;\n  canvas.width = 64;\n  const ctx = canvas.getContext('2d');\n  ctx.fillStyle = '#99ccff';\n  ctx.font = '124px serif'; //'64px serif'\n  ctx.fillText('â—', -10, 70); //ðŸŒ˜ðŸŒ™âš¸â˜¾\n  ctx.fillStyle = 'white';\n  ctx.font = '102px serif'; //'64px serif'\n  ctx.fillText('â—', 8, 61); //ðŸŒ˜ðŸŒ™âš¸â˜¾\n  ctx.fillStyle = '#ffffe6';\n  ctx.font = '64px serif'; //'64px serif'\n  // ctx.fillText(text, -3, 47);\n  ctx.fillText(text, 4, 54);\n  ctx.fillStyle = 'black';\n  ctx.font = '64px serif'; //'64px serif'\n  ctx.fillText(text, 0, 50);\n  ctx.fillText(text, 1, 51);\n\n  const link = document.createElement('link');\n  const oldLinks = document.querySelectorAll('link[rel=\"icon\"]');\n  oldLinks.forEach(e => e.parentNode.removeChild(e));\n  link.id = 'dynamic-favicon';\n  link.rel = 'icon';\n  link.href = canvas.toDataURL();\n  document.head.appendChild(link);\n}\nconst setIcon = () => {\n  title.innerHTML = resin();\n  // const icon = document.querySelector('#icon');\n  const r = resin();\n  changeFavicon(r);\n  // if (r >= 160) {\n  //   icon.href = './icons/resinlaser.ico';\n  //   console.log(icon);\n  //   return;\n  // }\n  // if (r >= 60) {\n  //   icon.href = './icons/resin60.ico';\n  //   console.log(icon);\n  //   return;\n  // }\n  // if (r >= 40) {\n  //   icon.href = './icons/resin40.ico';\n  //   console.log(icon);\n  //   return;\n  // }\n  // if (r >= 20) {\n  //   icon.href = './icons/resin20.ico';\n  //   console.log(icon);\n  //   return;\n  // }\n  // if (r >= 10) {\n  //   icon.href = './icons/resin10.ico';\n  //   console.log(icon);\n  //   return;\n  // }\n  // icon.href = './icons/resin0.ico';\n  // console.log(icon);\n};\n// --------------------------------------\n// --------------------------------------\nadd20.addEventListener('click', () => {\n  if (resin() + 20 <= 160) {\n    resinInput.value = Number(resinInput.value) + 20;\n    saveData();\n  } else {\n    resinInput.value = 160;\n  }\n});\nremove20.addEventListener('click', () => {\n  if (resin() - 20 >= 0) {\n    resinInput.value = Number(resinInput.value) - 20;\n    saveData();\n  } else {\n    resinInput.value = 0;\n  }\n});\nresinInput.addEventListener('change', onInputResinChange);\nsaveCheckbox.addEventListener('change', onSaveCheckbox);\nlet countdownDate = getGoalDateByResin(resin(), 160); // =new Date();\nsetRTimer();\n// SRTInterval=getMSToNearestResin();\nsingleResinTimer = setInterval(() => {\n  // SRTInterval=RESIN_MS;\n  clearInterval(singleResinTimer);\n  SRTTick();\n  singleResinTimer = setInterval(SRTTick, RESIN_MS);\n}, getMSToNearestResin());\nsetIcon();\n// --------------------------------------\n// --------------------------------------\n"],"names":["$3da008038f38d83c$var$RESIN_MS","$3da008038f38d83c$var$RESIN_MS_DAILY_DELAY","$3da008038f38d83c$var$DATE_DISPLAY_OPTIONS","year","month","day","hour","minute","$3da008038f38d83c$var$resinInput","document","querySelector","$3da008038f38d83c$var$resin","parseInt","value","$3da008038f38d83c$var$saving","checked","$3da008038f38d83c$var$next20","$3da008038f38d83c$var$next40","$3da008038f38d83c$var$next60","$3da008038f38d83c$var$next120","$3da008038f38d83c$var$fullAt","$3da008038f38d83c$var$add20","$3da008038f38d83c$var$remove20","$3da008038f38d83c$var$warningFull","$3da008038f38d83c$var$saveCheckbox","$3da008038f38d83c$var$title","$3da008038f38d83c$var$initNow","$3da008038f38d83c$var$lastData","date","Number","Date","resin","saving","$3da008038f38d83c$var$saveData","$3da008038f38d83c$var$setIcon","settings","console","log","localStorage","setItem","JSON","stringify","$h6c0i","Notify","success","parse","getItem","betweenSavedTime","addedResin","Math","floor","newResin","warning","$3da008038f38d83c$var$updateData","$3da008038f38d83c$var$singleResinTimer","$3da008038f38d83c$var$SRTTick","info","concat","$3da008038f38d83c$var$objectifyMs","ms","second","days","String","padStart","hours","minutes","seconds","$3da008038f38d83c$var$getGoalDateByResin","resin1","neededResin","$3da008038f38d83c$var$DateObjToStr","d","format","arguments","length","$3da008038f38d83c$var$updateR","filledMS","filledDate","innerHTML","d60","toLocaleDateString","d120","getDay","getHours","text","canvas","createElement","height","width","ctx","getContext","fillStyle","font","fillText","link","querySelectorAll","forEach","e","parentNode","removeChild","id","rel","href","toDataURL","head","appendChild","$3da008038f38d83c$var$changeFavicon","addEventListener","failure","now","todayMS","nextRMS","nextRMins","nextRSecs","setInterval","clearInterval","getMinutes","getSeconds","getMilliseconds"],"version":3,"file":"04-resinTimer.ed522050.js.map"}